(()=>{"use strict";var e={338:(e,t,r)=>{var o=r(824);t.H=o.createRoot,o.hydrateRoot},824:e=>{e.exports=window.ReactDOM}},t={};const r=window.React;var o=function r(o){var i=t[o];if(void 0!==i)return i.exports;var n=t[o]={exports:{}};return e[o](n,n.exports,r),n.exports}(338);const i=({attributes:e,id:t})=>{const{officeViewer:o,disableFullScreen:i}=e,{officeFile:n}=o,l=`#${t}`;let a=`\n        ${l} {\n            position: relative;\n        }\n        ${l} #block {\n            position: absolute;\n            top: 0;\n            right: 20px;\n            width: 100%;\n            height: ${n&&"pptx"===n?.url?.split(".").pop().toLowerCase()?"calc(100% - 30px)":"calc(100% - 55px)"};\n        }\n    `;return i&&(a+=`\n        ${l} #disableFullscreen {\n            position: absolute;\n            bottom: 0;\n            right: 0px;\n            width: 100px;\n            height: 50px;\n        }\n    `),a+=`\n    ${l} .disablePopout {\n            width: 80px;\n            height: 150px;\n            position: absolute;\n            opacity: 0;\n            right: 0px;\n            top: 0px;\n        }\n`,(0,r.createElement)(r.Fragment,null,(0,r.createElement)("style",{dangerouslySetInnerHTML:{__html:a.replace(/\s+/g," ")}}))},n=({attributes:e})=>{const{officeViewer:t}=e,{dropboxURL:o,width:i,height:n}=t,l=o.replace("www.dropbox.com","dl.dropboxusercontent.com").replace("?dl=0","");return(0,r.createElement)(r.Fragment,null,o&&(0,r.createElement)("iframe",{src:`https://docs.google.com/gview?url=${encodeURIComponent(l)}&embedded=true`,style:{border:"none"},width:i,height:n,frameBorder:"0",title:"Dropbox Document Viewer"}))},l=({attributes:e})=>{const{officeViewer:t}=e,{googleDriveURL:o,height:i,width:n}=t;return(0,r.createElement)("div",null,o&&(0,r.createElement)("iframe",{id:"s_pdf_frame",src:o,style:{margin:"0 auto"},height:i,width:n,frameBorder:"0"}))},a=({attributes:e})=>{const{officeViewer:t}=e,{officeFile:o,height:i,width:n}=t;return(0,r.createElement)(r.Fragment,null,o?(0,r.createElement)("iframe",{id:"s_pdf_frame",src:`//docs.google.com/gview?embedded=true&url=${o.url}`,style:{margin:"0 auto",padding:"10px"},height:i,width:n,frameBorder:"0"}):null)},c=({attributes:e})=>{const{officeViewer:t}=e,{officeFile:o,height:i,width:n,isRemoveDownloadBtn:l,isRemoveFullScreen:a}=t,c=o?.url?.split(".").pop().toLowerCase();return(0,r.createElement)(r.Fragment,null,o?(0,r.createElement)("div",{style:{position:"relative",width:n,height:i}},(0,r.createElement)("iframe",{id:"s_pdf_frame",src:`https://view.officeapps.live.com/op/embed.aspx?src=${o.url}`,height:i,width:n,frameBorder:"0",style:{position:"absolute",top:0,left:0}}),l&&"pptx"===c&&(0,r.createElement)("div",{style:{position:"absolute",bottom:"2px",right:"40px",width:"50px",height:"21px",background:"#444444",zIndex:2}}),a&&"pptx"===c&&(0,r.createElement)("div",{style:{position:"absolute",bottom:"2px",right:"6px",width:"35px",height:"21px",background:"#444444",zIndex:2}})):null)},d=({attributes:e})=>{const{officeViewer:t}=e,{officeFile:o,height:i,width:n}=t;return(0,r.createElement)(r.Fragment,null,o?(0,r.createElement)("iframe",{id:"s_pdf_frame",src:`${window?.eovData?.pdfJsFilePath}?file=${o.url}`,height:i,width:n}):null)},s=({attributes:e,id:t})=>{const{officeViewer:o}=e,{officeFile:i,showDownloadBtnOnTop:s,showFileNameOnTop:m,viewer:u,docSource:p,disablePopout:b,disableRightClick:h}=o;return(0,r.useEffect)(()=>{if(!h)return;const e=e=>e.preventDefault();document.addEventListener("contextmenu",e);const t=setTimeout(()=>{const e=document.getElementById("s_pdf_frame");e?.contentWindow?.document&&(e.contentWindow.document.oncontextmenu=e=>{e.preventDefault()})},1e3);return()=>{document.removeEventListener("contextmenu",e),clearTimeout(t)}},[h]),(0,r.createElement)(r.Fragment,null,(0,r.createElement)("div",{className:"eovOfficeViewer",id:t},"library"===p&&(0,r.createElement)(r.Fragment,null,m&&("googleDrive"!==p||"dropbox"!==p)&&(0,r.createElement)("p",null,"File Name: ",i?.title),s&&(0,r.createElement)("button",{onClick:()=>{const e=document.createElement("a");e.href=i.url,e.download=i.title||"downloaded-file",document.body.appendChild(e),e.click(),document.body.removeChild(e)},style:{marginBottom:"30px"}},"Download File")),h?(0,r.createElement)(r.Fragment,null,(0,r.createElement)("div",{id:"wrapper",style:{position:"relative"},className:"eov_wrapper"},(0,r.createElement)("div",{id:"block"}),(0,r.createElement)("div",{id:"disableFullscreen"}),"library"===p&&"google"===u&&(0,r.createElement)(a,{attributes:e}),"library"===p&&"microsoft"===u&&(0,r.createElement)(c,{attributes:e}),"library"===p&&"js"===u&&(0,r.createElement)(d,{attributes:e}),"googleDrive"===p&&(0,r.createElement)(l,{attributes:e}),"dropbox"===p&&(0,r.createElement)(n,{attributes:e})),b&&(0,r.createElement)("div",{className:"disablePopout"})):(0,r.createElement)(r.Fragment,null,"library"===p&&"google"===u&&(0,r.createElement)(a,{attributes:e}),"library"===p&&"microsoft"===u&&(0,r.createElement)(c,{attributes:e}),"library"===p&&"js"===u&&(0,r.createElement)(d,{attributes:e}),"googleDrive"===p&&(0,r.createElement)(l,{attributes:e}),"dropbox"===p&&(0,r.createElement)(n,{attributes:e}),b&&(0,r.createElement)("div",{className:"disablePopout"}))))};document.addEventListener("DOMContentLoaded",()=>{document.querySelectorAll(".wp-block-eov-embed-office-viewer").forEach(e=>{const t=JSON.parse(e.dataset.attributes);(0,o.H)(e).render((0,r.createElement)(r.Fragment,null,(0,r.createElement)(i,{attributes:t,id:e.id}),(0,r.createElement)(s,{attributes:t,id:e.id}))),e?.removeAttribute("data-attributes")})})})();